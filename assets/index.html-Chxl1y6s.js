import{_ as a,c as i,a as e,o as t}from"./app-CrDOs8BQ.js";const n="/MyBlog/assets/best_practices-C7A-KSmN.png",l="/MyBlog/assets/best_practices1-DBf9HJUK.png",p="/MyBlog/assets/best_practices2-CvWbV8rg.png",c={};function d(h,s){return t(),i("div",null,s[0]||(s[0]=[e('<p>假设有以下代码：</p><p><img src="'+n+'" alt="代码示意图" width="522" height="192"></p><ul><li><code>master</code>分支是主分支，演进路线，代码都往主干分支合并</li><li><code>L2020JS1201</code>分支，是版本分支，即拉出转测，准备2020年12月1号发布版本</li><li><code>story#22306</code>分支，是我们做过的某一个需求，该需求已合并master分支，</li></ul><p><strong>现在需求来了，<code>22306</code>这个需求要提前一个版本上线，在<code>L2020JS1201</code>版本里发布。</strong></p><p>我们分析一下场景:</p><ul><li><code>story#22306</code>分支发育的晚于<code>L2020JS1201</code>分支</li><li>尽量操作简单、便捷</li><li>一旦出现问题，方便回退</li><li>不要出现多余的代码引入</li></ul><div class="hint-container warning"><p class="hint-container-title">说明</p><p>如果是<code>story#22306</code>分支早于<code>L2020JS1201</code>分支，那么问题就很简单，我们直接将<code>story#22306</code>分支压缩合并过去即可</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">merge</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">story#22306</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--squash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><h2 id="三种手段可以用" tabindex="-1"><a class="header-anchor" href="#三种手段可以用"><span>三种手段可以用：</span></a></h2><ul><li><p><strong><code>merge</code></strong> 合并分支</p></li><li><p><strong><code>rebase</code></strong> 合并分支</p></li><li><p><strong><code>cherry-pick</code></strong> 遴选代码合并过去</p></li></ul><p><strong>存在的问题</strong></p><ul><li><p>merge和rebase直接进行分支合并，都会先寻找一个公共祖先，直接合并分支可能会带来多余的代码。<br> 我们查看提交历史发现，提交<code>C</code>是多余的，我们不想合入。</p></li><li><p>使用<code>cherry-pick</code>是个不错的选择，可以直接操作一段commit，将<code>story#22306</code>分支的提交直接遴选过去,同样问题也很明显，一旦发生问题，需要回退好几个提交的代码</p></li></ul><h2 id="三种方案可利用特性" tabindex="-1"><a class="header-anchor" href="#三种方案可利用特性"><span>三种方案可利用特性：</span></a></h2><ul><li><strong><code>merge --squash</code></strong> 可以将一个分支压缩合并成一个提交到另外一个分支</li><li><strong><code>cherry-pick</code></strong> 可以遴选一段提交</li><li><strong><code>rebase -i</code></strong> 交互式变基，可以对提交进行增删改、合并。</li></ul><h2 id="最终两种推荐方案" tabindex="-1"><a class="header-anchor" href="#最终两种推荐方案"><span>最终两种推荐方案：</span></a></h2><h3 id="_1-创建临时分支-将story-22306分支整体压缩成一个提交-然后将该临时分支遴选到l2020js1201分支" tabindex="-1"><a class="header-anchor" href="#_1-创建临时分支-将story-22306分支整体压缩成一个提交-然后将该临时分支遴选到l2020js1201分支"><span>1. 创建临时分支，将<code>story#22306</code>分支整体压缩成一个提交，然后将该临时分支遴选到<code>L2020JS1201</code>分支</span></a></h3><p>操作示意图：</p><p><img src="'+l+`" alt="代码示意图" width="632" height="252"></p><h4 id="详细操作" tabindex="-1"><a class="header-anchor" href="#详细操作"><span>详细操作</span></a></h4><ul><li><p>首先基于提交<code>C</code>创建<code>temp</code>临时分支</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">branch</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">temp</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">C</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>切换到该分支</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">checkout</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">temp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>将<code>story#22306</code>分支压缩合并到该分支，生成一个新的提交<code>L</code></p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">merge</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">story#22306</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--squash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">说明</p><p>为防止部分终端可能存在语法问题，可以将<code>story#22306</code>使用引号括起来，标识这是一个完整参数</p></div></li><li><p>切换到<code>L2020JS1201</code>分支，将压缩合并产生的新提交<code>L</code>遴选过来，就算完成了。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">checkout</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">L2020JS1201</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">cherry-pick</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">L</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_2-将story-22306分支上的提交遴选到l2020js1201分支-然后将这部分提交利用交互式变基压缩成一个提交" tabindex="-1"><a class="header-anchor" href="#_2-将story-22306分支上的提交遴选到l2020js1201分支-然后将这部分提交利用交互式变基压缩成一个提交"><span>2. 将<code>story#22306</code>分支上的提交遴选到<code>L2020JS1201</code>分支，然后将这部分提交利用交互式变基压缩成一个提交</span></a></h3><p>操作示意图： <img src="`+p+`" alt="代码示意图" width="711" height="442"></p><ul><li><p>首先使用<code>cherry-pick</code>将代码遴选到<code>L2020JS1201</code>分支</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">checkout</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">L2020JS1201</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">cheerry-pick</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">J..K</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用交互式变基将代码压缩成一个新的提交<code>L</code>，因为<code>J..K</code>共两个提交，所以参数为2。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">rebase</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-i</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HEAD~2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><div class="hint-container warning"><p class="hint-container-title">举一反三</p><p>某条分支上最新的一段提交压缩成为一个提交，使用reset也可以达到同样的效果</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">reset</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--soft</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">I</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">commit</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-m</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">message</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div>`,23)]))}const o=a(c,[["render",d],["__file","index.html.vue"]]),k=JSON.parse('{"path":"/Git/tei9uo1f/","title":"通过分支管理需求、问题单","lang":"zh-CN","frontmatter":{"title":"通过分支管理需求、问题单","createTime":"2025/02/16 21:13:08","permalink":"/Git/tei9uo1f/"},"headers":[],"readingTime":{"minutes":2.63,"words":789},"git":{"updatedTime":1742050940000,"contributors":[{"name":"kangkang shang","username":"kangkang shang","email":"535634238@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/kangkang shang?v=4","url":"https://github.com/kangkang shang"}]},"filePathRelative":"notes/Git/2.最佳实践/1.通过分支管理需求、问题单.md"}');export{o as comp,k as data};
