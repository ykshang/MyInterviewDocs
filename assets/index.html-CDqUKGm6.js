import{_ as i,c as a,a as e,o as t}from"./app-CrDOs8BQ.js";const n={};function l(p,s){return t(),a("div",null,s[0]||(s[0]=[e('<h2 id="一、概念" tabindex="-1"><a class="header-anchor" href="#一、概念"><span>一、概念</span></a></h2><p><strong>HTTP 劫持（HTTP Hijacking）是指攻击者在通信过程中拦截和篡改用户的 HTTP 请求或响应，从而实施恶意操作或窃取用户的敏感信息。</strong></p><p>HTTP 劫持通常发生在不安全的网络环境中，例如公共 Wi-Fi 或未加密的 HTTP 连接。</p><p>HTTP 劫持可能发生在网络中的任何节点，攻击者可以截获用户发送的请求，修改请求内容，或截获服务器返回的响应，篡改响应内容。</p><h2 id="二、常见形式" tabindex="-1"><a class="header-anchor" href="#二、常见形式"><span>二、常见形式</span></a></h2><ol><li><p><strong>中间人攻击（Man-in-the-Middle, MITM）：</strong> 攻击者在用户与服务器之间插入自己，拦截并篡改双方的通信内容。例如：</p><ul><li>窃取用户的登录凭证、会话 Cookie 或其他敏感信息。</li><li>篡改网页内容，插入广告或恶意脚本。</li></ul></li><li><p><strong>DNS 劫持：</strong> 攻击者通过篡改 DNS 解析结果，将用户引导到恶意服务器。例如：</p><ul><li>用户访问 <code>example.com</code>，但被重定向到攻击者控制的假冒网站。</li></ul></li><li><p><strong>HTTP 响应劫持：</strong> 攻击者篡改服务器返回的 HTTP 响应内容。例如：</p><ul><li>在网页中插入恶意脚本或广告。</li><li>替换下载的文件为恶意软件。</li></ul></li><li><p><strong>会话劫持（Session Hijacking）：</strong> 攻击者窃取用户的会话 Cookie 或令牌，冒充用户访问受保护的资源。</p></li><li><p><strong>Wi-Fi 热点劫持：</strong> 在公共 Wi-Fi 环境中，攻击者创建一个假冒的热点，诱使用户连接，从而监控或篡改用户的网络流量。</p></li></ol><h2 id="三、危害" tabindex="-1"><a class="header-anchor" href="#三、危害"><span>三、危害</span></a></h2><ul><li><strong>数据泄露：</strong> 用户的敏感信息（如密码、银行卡号）可能被窃取。</li><li><strong>恶意内容注入：</strong> 攻击者可以在网页中插入恶意脚本（如挖矿脚本、钓鱼页面）。</li><li><strong>隐私泄露：</strong> 用户的浏览行为可能被监控和记录。</li><li><strong>经济损失：</strong> 例如，篡改支付页面导致用户资金损失。</li></ul><h2 id="四、防御措施" tabindex="-1"><a class="header-anchor" href="#四、防御措施"><span>四、防御措施</span></a></h2><ol><li><p><strong>使用 HTTPS ：</strong> HTTPS 通过 TLS/SSL 加密通信内容，防止数据被窃取或篡改。确保网站全面启用 HTTPS，并配置 HSTS（HTTP Strict Transport Security）以强制使用 HTTPS。</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Strict-Transport-Security:</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">max-age=31536000;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">includeSubDomains;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">preload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>避免使用公共 Wi-Fi ：</strong> 公共 Wi-Fi 通常不安全，容易被攻击者利用。如果必须使用，建议通过 VPN 加密流量。</p></li><li><p><strong>启用 DNSSEC ：</strong> DNSSEC（Domain Name System Security Extensions）可以防止 DNS 劫持，确保域名解析结果的真实性。</p></li><li><p><strong>定期检查证书：</strong> 确保网站使用的 SSL/TLS 证书有效且未被篡改。</p></li><li><p><strong>使用内容安全策略（CSP）：</strong> CSP 可以防止恶意脚本注入，限制资源的加载来源。</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Content-Security-Policy:</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">default-src</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;self&#39;;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">script-src</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;self&#39;;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">style-src</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;self&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>设置安全的 Cookie 属性：</strong> 使用 <code>Secure</code> 和 <code>HttpOnly</code> 属性保护 Cookie，防止被窃取。</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Set-Cookie:</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">sessionId=abc123;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Secure;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HttpOnly;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">SameSite=Strict</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>使用 VPN ：</strong> VPN 可以加密所有网络流量，防止中间人攻击。</p></li><li><p><strong>用户教育：</strong> 提醒用户不要点击可疑链接，避免连接不安全的 Wi-Fi，定期检查浏览器地址栏的 HTTPS 标识。</p></li></ol><h2 id="五、检测" tabindex="-1"><a class="header-anchor" href="#五、检测"><span>五、检测</span></a></h2><ol><li><p><strong>检查网络流量：</strong> 使用工具（如 Wireshark）分析网络流量，查看是否有异常请求或响应。</p></li><li><p><strong>监控 DNS 解析：</strong> 检查 DNS 解析结果是否正确，避免被重定向到恶意网站。</p></li><li><p><strong>检查网页内容：</strong> 定期检查网页是否被注入恶意脚本或广告。</p></li><li><p><strong>使用浏览器扩展：</strong> 安装安全扩展（如 HTTPS Everywhere）以确保始终使用 HTTPS。</p></li></ol><h2 id="六、总结" tabindex="-1"><a class="header-anchor" href="#六、总结"><span>六、总结</span></a></h2><p>HTTP 劫持是一种严重的安全威胁，可能导致数据泄露、隐私侵犯和经济损失。通过使用 HTTPS、启用 DNSSEC、配置 CSP 等措施，可以有效防御 HTTP 劫持。同时，用户也应提高安全意识，避免在不安全的网络环境中进行敏感操作。</p>',14)]))}const o=i(n,[["render",l],["__file","index.html.vue"]]),c=JSON.parse('{"path":"/Security/xs9z7d38/","title":"什么是 HTTP 劫持（HTTP Hijacking）攻击？如何防范？","lang":"zh-CN","frontmatter":{"title":"什么是 HTTP 劫持（HTTP Hijacking）攻击？如何防范？","createTime":"2025/03/15 12:48:39","permalink":"/Security/xs9z7d38/"},"headers":[],"readingTime":{"minutes":3.34,"words":1003},"git":{"updatedTime":1742050940000,"contributors":[{"name":"kangkang shang","username":"kangkang shang","email":"535634238@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/kangkang shang?v=4","url":"https://github.com/kangkang shang"}]},"filePathRelative":"notes/Security/7.什么是 HTTP 劫持（HTTP Hijacking）攻击？如何防范？.md"}');export{o as comp,c as data};
